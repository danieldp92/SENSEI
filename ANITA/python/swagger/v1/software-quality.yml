swagger: "2.0"
info:
  description: This is the swagger file that goes with our server code
  version: "1.0.0"
  title: Swagger REST Article
consumes:
  - "application/json"
produces:
  - "application/json"

basePath: "/v1/software-quality"

# Paths supported by the server application
paths:
  /projects/:
    get:
      operationId: "api.endpoints.software_quality.projects.projects_list"
      summary: "Get a list containing all the projects"

      produces:
        - "application/json"

      responses:
        200:
          description: "The json containing all the projects"
    delete:
      operationId: "api.endpoints.software_quality.projects.delete_projects"
      summary: "Delete a list of projects used for the software quality module"
      consumes:
        - "multipart/form-data"
      produces:
        - "application/json"

      parameters:
        - in:  formData
          name: project_list
          required: true
          type: array
          items:
            type: string

      responses:
        204:
          description: "Projects removed"
        404:
          description: "Project(s) not found"
        500:
          description: "Internal server error: general error used if the server raises an exception unmanaged by other 5xx status code"
        503:
          description: "Database unreachable"

  /projects/status/:
    get:
      operationId: "api.endpoints.software_quality.projects.projects_status"
      summary: "Get the upload status of all projects"

      produces:
        - "application/json"

      responses:
        200:
          description: "The json contains the result and/or status  of all the upload project tasks"

  /projects/info/:
    get:
      operationId: "api.endpoints.software_quality.projects.projects_info"
      summary: "Get the info of a projects (number of files, dumps)"

      produces:
        - "application/json"

      responses:
        200:
          description: "Json containing the info of all projects"

  /projects/known-projects/:
    get:
      operationId: "api.endpoints.software_quality.projects.get_known_projects"
      summary: "Get the list of known databases already preprocessed in the server"

      produces:
        - "application/json"

      responses:
        200:
          description: "A json containing the list of all known databases"
          schema:
            type: boolean

  /projects/{project_name}:
    get:
      operationId: "api.endpoints.software_quality.projects.get_project"
      summary: "Endpoint used to obtain all the data related to a project from the db"

      consumes:
        - "application/xml"
      produces:
        - "application/json"

      parameters:
        - in:  path
          name: project_name
          required: true
          type: string

      responses:
        200:
          description: "A json containing all information about the project sent by input"
        404:
          description: "Project not found"
        500:
          description: "Internal server error: general error used if the server raises an exception unmanaged by other 5xx status code"
        503:
          description: "Database unreachable"
    post:
      operationId: "api.endpoints.software_quality.projects.load_new_project"
      summary: "Load a new project for software quality module into the database"
      consumes:
        - "multipart/form-data"
      produces:
        - "application/json"

      parameters:
        - in:  formData
          name: project_zip
          required: true
          type: file
        - in: path
          name: project_name
          required: true
          type: string
        - in:  formData
          name: known_dataset
          required: false
          type: string

      responses:
        202:
          description: "Upload process accepted (to see the upload status, use the relative endpoint). The json contains the info of the project"
        400:
          description: "Project already created"
        500:
          description: "Upload process failed"
    put:
      operationId: "api.endpoints.software_quality.projects.update_project"
      summary: "Update a project adding new pages"
      consumes:
        - "multipart/form-data"
      produces:
        - "application/json"

      parameters:
        - in:  formData
          name: project_zip
          required: true
          type: file
        - in:  path
          name: project_name
          required: true
          type: string

      responses:
        202:
          description: "Upload process accepted (to see the upload status, use the relative endpoint). The json contains the info of the project"
        404:
          description: "Project not found"
        500:
          description: "Upload process failed"
    delete:
      operationId: "api.endpoints.software_quality.projects.delete_project"
      summary: "Delete a project used for the software quality module"

      consumes:
        - "application/xml"
      produces:
        - "application/json"

      parameters:
        - in:  path
          name: project_name
          required: true
          type: string

      responses:
        204:
          description: "Project removed"
        404:
          description: "Project not found"
        500:
          description: "Internal server error: general error used if the server raises an exception unmanaged by other 5xx status code"
        503:
          description: "Database unreachable"

  /projects/{project_name}/info/:
    get:
      operationId: "api.endpoints.software_quality.projects.project_info"
      summary: "Get the info of a projects (number of files, dumps)"

      consumes:
        - "application/xml"
      produces:
        - "application/json"

      parameters:
        - in: path
          name: project_name
          required: true
          type: string

      responses:
        200:
          description: "Json containing the info of a project"
        404:
          description: "Project not found"

  /projects/{project_name}/status/:
    get:
      operationId: "api.endpoints.software_quality.projects.project_status_all"
      summary: "Get the upload status of a projects"

      consumes:
        - "application/xml"
      produces:
        - "application/json"

      parameters:
        - in: path
          name: project_name
          required: true
          type: string

      responses:
        200:
          description: "Task executed successfully. The json contains the result of the upload project task"
        202:
          description: "Task is running. The json contains the status of the upload project task"
        400:
          description: "Project dump not found"
        500:
          description: "Task failed. The json contains the result of the upload project task"

  /projects/{project_name}/status/{timestamp}:
    get:
      operationId: "api.endpoints.software_quality.projects.project_status"
      summary: "Get the upload status of a projects"

      consumes:
        - "application/xml"
      produces:
        - "application/json"

      parameters:
        - in: path
          name: project_name
          required: true
          type: string
        - in:  path
          name: timestamp
          required: true
          type: string

      responses:
        200:
          description: "Task executed successfully. The json contains the result of the upload project task"
        202:
          description: "Task is running. The json contains the status of the upload project task"
        400:
          description: "Project dump not found"
        500:
          description: "Task failed. The json contains the result of the upload project task"

  /experimentation/:
    get:
      operationId: "api.endpoints.software_quality.experimentation.get_experimentation_list"
      summary: "Get the list of all experimentations available"

      produces:
        - "application/json"

      responses:
        200:
          description: "The list of all experimentations available with their respective id"

  /experimentation/{project_name}/{experimentation_id}:
    get:
      operationId: "api.endpoints.software_quality.experimentation.run_experimentation"
      summary: "Run experimentation(s) on a project"

      consumes:
        - "application/xml"
      produces:
        - "application/json"

      parameters:
        - in: path
          name: project_name
          required: true
          type: string
        - in:  path
          name: experimentation_id
          required: true
          type: string

      responses:
        202:
          description: "Experimentation task started. To see the status and results, use the relative endpoint. The json content contains the info of the experimentation"
        404:
          description: "Project and/or experimentation not found. More information in the json"
        500:
          description: "Internal server error: general error used if the server raises an exception unmanaged by other 5xx status code"

  /experimentation/{project_name}/{experimentation_id}/status/:
    get:
      operationId: "api.endpoints.software_quality.experimentation.experimentation_status"
      summary: "Get the status of an experimentation"

      consumes:
        - "application/xml"
      produces:
        - "application/json"

      parameters:
        - in: path
          name: project_name
          required: true
          type: string
        - in:  path
          name: experimentation_id
          required: true
          type: string

      responses:
        200:
          description: "Task executed successfully. The json contains the result of the experimentation project task"
        202:
          description: "Task is running. The json contains the status of the experimentation project task"
        404:
          description: "Experimentation task not found"
        500:
          description: "Task failed. The json contains the result of the experimentation project task"

